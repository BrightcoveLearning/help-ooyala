<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2005"/>
<meta name="DC.rights.owner" content="(C) Copyright 2005"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Integrating Google IMA Ads"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="pbv4_ads_dev_google_ima"/>
<meta name="DC.Language" content="en-us"/>
<link rel="stylesheet" type="text/css" href="../css/commonltr.css"/>
<link rel="stylesheet" type="text/css" href="../css/ooyala.css"/>
<title>Integrating Google IMA Ads</title>
</head>
<body id="pbv4_ads_dev_google_ima">


  <h1 class="title topictitle1">Integrating Google IMA Ads</h1>

  <div class="body conbody">
    <div class="section">You can integrate Google IMA ads with Player V4 using the <a class="xref" href="pbv4_ads_dev_chapter_googleima.html">Google IMA Ad Plugin</a> (<samp class="ph codeph">google_ima.min.js</samp>).</div>
   
    <div class="section"><h2 class="title sectiontitle">Enabling the Google IMA Ad Source for Your Account</h2> Before you can use
      Google IMA ad integration: 
      <ol class="ol">
        <li class="li">Log into the <span class="ph">Ooyala <a class="xref" href="../../../../../../../contact.html" target="_blank">Customer Portal</a></span>.</li>

        <li class="li">Submit a ticket requesting that the Google IMA ad source be added to your
          Ooyala account.</li>

      </ol>
</div>

      <div class="section"><h2 class="title sectiontitle">Options for Associating Ad Tags with Your Video Assets</h2>Once the Google
      IMA ad source is enabled for your account, you can associate Google IMA ad tags with your
      videos using: <ul class="ul" id="pbv4_ads_dev_google_ima__ul_tvr_t5b_dm">
        <li class="li">Backlot Ad Sets.
          Create ad sets with the Backlot UI or API. </li>

        <li class="li">Player Embedded Parameters.
          Specify embedded parameters at the page level of the player.</li>

      </ul>
</div>

    <div class="section"><h2 class="title sectiontitle">Notes About the Google IMA Plugin</h2>
      <ul class="ul">
        <li class="li">Ads that use Backlot settings will be loaded dynamically before the ad position (as
        determined in Backlot). The ad will now be requested and loaded at the specified ad position
        (via Backlot settings or Ad Rules). The video will be paused at the pre-determined ad
        position and an ad request will be made. The loading icon will be displayed until a
        successful ad response is returned, or the video playback will resume if an ad error is
        detected. These behavior changes were made because publishers can be very specific about
        when ad requests are made. </li>

      <li class="li">For the Google IMA ad plugin, the ad marquee and ad control bar configurations in
        skin.json are ignored (and are forcibly set to off) to avoid blocking ad
        interactivity.</li>

        </ul>

    </div>

    
    <div class="section"><h2 class="title sectiontitle">Loading the Google IMA Ad Plugin on a Page</h2>
      <div class="note note"><span class="notetitle">Note:</span> 
        <ul class="ul">
          <li class="li">If you use Backlot to generate your HTML embed code, and you choose
            the <strong class="ph b">V4 HTML5 Standard Player Embed Code (recommended)</strong> option, the Google IMA plugin
            is automatically included and should not be explicitly added to the web page where you
            launch the player. For details, see <a class="xref" href="../tasks/publishing_manual_embed.html">Configuring Player Embed Settings in Backlot</a>.</li>
 
          <li class="li">If you choose the <strong class="ph b">V4 HTML5 Player Embed Code (Advanced)</strong> option in Backlot, or if you manually create the HTML embed code yourself, you need to add the Google IMA plugin  to your web page so that the Google IMA plugin loads
            before the player is created. </li>

        </ul>
</div>

      
      
      For every page on which you
      want to use the Google IMA plugin with a player (regardless of how you associated Google IMA ads with your videos): 
      <ol class="ol">
        <li class="li" id="pbv4_ads_dev_google_ima__load_plugin">Add the <samp class="ph codeph">google_ima.min.js</samp> script to the page where you are loading the
          player. You must load this plugin <em class="ph i">after</em> you load <samp class="ph codeph">core.min.js</samp>.
          <pre class="pre codeblock">&lt;script language=“javascript" src="<span class="ph"><strong class="ph b"><em class="ph i">url_where_hosted</em></strong></span>/google_ima.min.js"&gt;&lt;/script&gt;</pre>
</li>

        <li class="li">Associate the player with the Ooyala Google IMA ad plugin by passing in
            <samp class="ph codeph">google-ima-ads-manager</samp> as one of the player parameters during the
          player creation (<var class="keyword varname">OO.Player.create</var>).</li>

      </ol>
</div>

    
    <div class="section" id="pbv4_ads_dev_google_ima__backlotAdSet"><h2 class="title sectiontitle">Option: Integrate with Google IMA via Backlot Ad Sets</h2>
      <ol class="ol">
        <li class="li">Create a Google IMA ad set using the Backlot UI or Backlot API:
          <ul class="ul">
          <li class="li"><strong class="ph b">Backlot UI</strong>: To create an ad set using the Backlot UI, see <a class="xref" href="../tasks/monetization_ads_adsets_integratingadnetworks.html" title="Instead of using your own assets, you can work with other ad sources.">Creating Ad Sets for Integrating with Ad Sources</a>.The HTML5 player will respect the following Ad Set settings from
              Backlot: <ul class="ul">
                <li class="li">Ad Tag URL</li>

                <li class="li">Tracking Pixel URL</li>

                <li class="li">Ad positions</li>

                
                <li class="li">Overlay ads</li>

              </ul>
 Ad rules and page-level settings take precedence over Backlot settings. <div class="note note"><span class="notetitle">Note:</span> 
                <ul class="ul">
                  <li class="li">Choose the <strong class="ph b">Google IMA V3</strong> option for the ad source when creating this ad
                    set. Disregard any other options.</li>

                  <li class="li">If the Ad Tag is an Ad Rule, then you must select <strong class="ph b">Ad Rules</strong> in the Ad
                    Position drop-down.</li>

                </ul>

              </div>
 The <strong class="ph b">required fields</strong> for creating a Google IMA ad set are:
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">
                  <thead class="thead" align="left">
                    <tr class="row">
                      <th class="entry" valign="top" id="d417504e189">Field</th>

                      <th class="entry" valign="top" id="d417504e192">Description</th>

                    </tr>

                  </thead>

                  <tbody class="tbody">
                    <tr class="row">
                      <td class="entry" valign="top" headers="d417504e189 d417504e192 "><samp class="ph codeph"><span class="keyword parmname">Ad Set name</span></samp></td>

                      <td class="entry" valign="top" headers="d417504e189 d417504e192 ">Enter a name for the ad set.</td>

                    </tr>

                    <tr class="row">
                      <td class="entry" valign="top" headers="d417504e189 d417504e192 "><samp class="ph codeph"><span class="keyword parmname">Ad Tag</span></samp></td>

                      <td class="entry" valign="top" headers="d417504e189 d417504e192 ">Enter your Google IMA tag here. This is available from your DFP,
                        Adxchange, or Adsense account. See below for an example. </td>

                    </tr>

                  </tbody>

                </table>
</div>
Example Ad Tag:
              <pre class="pre codeblock"> <a class="xref" href="http://123fakeads.g.doubleclick.net/gampad/ads?sz=400x300&amp;iu=%2F6062%2Fiab_vast_samples&amp;ciu_szs=300x250%2C728x90&amp;impl=s&amp;gdfp_req=1&amp;env=vp&amp;output=xml_vast2&amp;unviewed_position_start=1&amp;url=%5Breferrer_url%5D&amp;correlator=%5Btimestamp%5D&amp;cust_params=iab_vast_samples%3Dlinear" target="_blank">http://123fakeads.g.doubleclick.net/gampad/ads?sz=400x300&amp;iu=%2F6062%2Fiab_vast_samples&amp;ciu_szs=300x250%2C728x90&amp;impl=s&amp;gdfp_req=1&amp;env=vp&amp;output=xml_vast2&amp;unviewed_position_start=1&amp;url=[referrer_url]&amp;correlator=[timestamp]&amp;cust_params=iab_vast_samples%3Dlinear</a></pre>
</li>

            <li class="li"><strong class="ph b">Backlot API</strong>: To create an ad set programmatically with the Backlot API, see <a class="xref" href="../api/ad_sets.html" title="Ad sets are ad configurations that control the ad experience of an asset during playback.">Ad Sets</a></li>

          </ul>

        </li>

        <li class="li">Assign an ad set to an asset or multiple assets using:<ul class="ul">
            <li class="li"><strong class="ph b">Backlot UI</strong>: To assign your Google IMA ad set to a single asset, see the
              Support Center topic <a class="xref" href="../tasks/asset_manage_monetization.html" title="You can monetize your content using advertisements or create a pay-per-view experience using paywalls.">Managing Monetization</a>. To assign your Google IMA ad set to multiple assets,
              see the Support Center topic <a class="xref" href="../tasks/asset_bulk.html" title="You can use the Backlot UI to apply settings to more than one asset at a time.">Bulk
                Applying Settings</a>.</li>

            <li class="li"><strong class="ph b">Player API</strong>: With the Player API, you can associate an ad set only with an
              asset on your web page. To associate an ad set with an asset on multiple players, you
              must replicate the code for each player. To associate an ad set with an asset using
              the Player API, see <a class="xref" href="../tasks/pbv4_assign_adsets_dynamic.html">Assigning Ad Sets Dynamically</a>.</li>

            <li class="li"><strong class="ph b">Backlot API</strong>: With the Backlot API, you can associate an ad set with an asset
              more concretely. When you associate an asset with an ad set using the Backlot API, the
              asset and the ad set will be paired together on any player and page on which you play
              the asset. To associate an asset with an ad set using the Backlot API, see <a class="xref" href="../api/asset_ad_set.html" title="You can associate ad sets with videos, live streams, and remote assets. For information about creating ad sets, refer to the Backlot User Guide.">Associate Ad Set with
              Asset</a>.</li>

          </ul>
</li>

      </ol>

    </div>


    <div class="section" id="pbv4_ads_dev_google_ima__params"><h2 class="title sectiontitle">Option: Integrate with Google IMA via Player Embedded Parameters</h2>
      <div class="note note"><span class="notetitle">Note:</span> <span class="ph">Wherever you see <samp class="ph codeph"><span class="ph"><strong class="ph b"><em class="ph i">url_where_hosted</em></strong></span></samp> in sample code, replace
    this (in your code) with the URL that points to where the resource is hosted. For a list of
    Ooyala-hosted paths, see <a class="xref" href="pbv4_resources.html">Ooyala-hosted Player V4 Resources</a>. The URL can point to a location on the same host (internal link) or on
    a separate host (prefixed with <samp class="ph codeph">http://</samp> or <samp class="ph codeph">https://</samp>). If you
    host resources yourself (see <a class="xref" href="pbv4_host.html">Hosting Player V4 Resources</a>), be sure to
    check for any path dependencies within the files.</span></div>

      <div class="p">
        <ol class="ol">
          <li class="li">Add the <samp class="ph codeph">google_ima.min.js</samp> script to the page where you are loading the
          player. You must load this plugin <em class="ph i">after</em> you load <samp class="ph codeph">core.min.js</samp>.
          <pre class="pre codeblock">&lt;script language=“javascript" src="<span class="ph"><strong class="ph b"><em class="ph i">url_where_hosted</em></strong></span>/google_ima.min.js"&gt;&lt;/script&gt;</pre>
</li>

          <li class="li">Use the Player V4 <var class="keyword varname">OO.Player.create</var> function to create the player. </li>

          <li class="li">Pass any global parameters. See <a class="xref" href="pbv4_configure_ads_embedded_params.html">Configuring Ad Parameters</a>.</li>

          <li class="li">Pass Google IMA ad tags to the Ooyala player using the
              <samp class="ph codeph">google-ima-ads-manager</samp> parameter and its child parameters. See <a class="xref" href="pbv4_ads_dev_google_ima_parameters.html">Google IMA Ad Parameters</a>. </li>

        </ol>

      </div>

      <div class="p">
        <div class="note note"><span class="notetitle">Note:</span> Ad sets that are loaded at the page level will override the ad set associated with the
          asset in Backlot.</div>

      </div>
<p class="p">Here is an example of how to override an ad set in the Google IMA ad manager on your web page. If
        you want to replace the Ad Set attached to your video (from Backlot), or if it does not have
        an IMA Ad Set already associated with it, you will replace <var class="keyword varname">"yourAdTagUrl"</var>
        with the actual Google IMA ad tag containing the response. Otherwise, you may leave it
        out.</p>
<div class="p"><pre class="pre codeblock">&lt;script&gt;
    var playerParam = {
      "pcode": "YOUR_PCODE",
      "playerBrandingId": "YOUR_PLAYER_ID",
      "skin": {
        // Config contains the configuration setting for player skin. Change to your local config when necessary.
        "config": "<span class="ph"><strong class="ph b"><em class="ph i">url_where_hosted</em></strong></span>/skin.json"
      },
       "google-ima-ads-manager": {
         "all_ads": [              
             {                
               "position_type":"r",                
               "tag_url":"http://pubads.g.doubleclick.net/1234567/ads?sz=640x480&amp;iu=/12345/pb_preroll_ad&amp;ciu_szs&amp;impl=s&amp;cmsid=123&amp;vid=1234567abcdefg&amp;gdfp_req=1&amp;env=vp&amp;output=xml_vast2&amp;unviewed_position_start=1&amp;url=[referrer_url]&amp;description_url=[description_url]&amp;correlator=[timestamp]"              
             }            
          ]          
        }
    };
    OO.ready(function() {
      window.pp = OO.Player.create("container", "YOUR_ASSET_ID", playerParam);
    });
&lt;script&gt;</pre>

        Here is a more complete example of Google IMA integration that will work for HTML5. The
        player branding_id of a player and the embed code of an asset can be found in the Embed tab
        on the MANAGE page of Backlot. </div>
<pre class="pre codeblock">&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;Google IMA Example&lt;/title&gt;
        &lt;!-- V4 JS core is required. Plugins such as skin, discovery and Advertising need to be loaded separately --&gt;
        &lt;script src="<span class="ph"><strong class="ph b"><em class="ph i">url_where_hosted</em></strong></span>/core.min.js"&gt;&lt;/script&gt;
        &lt;script src="<span class="ph"><strong class="ph b"><em class="ph i">url_where_hosted</em></strong></span>/other-plugin/discovery_api.min.js"&gt;&lt;/script&gt;
        &lt;!-- Change these html5-skin.min.css and html5-skin.js to your local build if necessary --&gt;
        &lt;script src="<span class="ph"><strong class="ph b"><em class="ph i">url_where_hosted</em></strong></span>/html5-skin.min.js"&gt;&lt;/script&gt;
        &lt;link rel="stylesheet" href="<span class="ph"><strong class="ph b"><em class="ph i">url_where_hosted</em></strong></span>/html5-skin.min.css"/&gt;
        &lt;!-- A Video Plugin is required. This example shows the Main Video Plugin --&gt;
        &lt;script src="<span class="ph"><strong class="ph b"><em class="ph i">url_where_hosted</em></strong></span>/main_html5.min.js"&gt;&lt;/script&gt;
        &lt;!-- Ad module --&gt;
        &lt;script src="<span class="ph"><strong class="ph b"><em class="ph i">url_where_hosted</em></strong></span>/google_ima.min.js"&gt;&lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="container" style="width:640px; height:360px;"&gt;&lt;/div&gt;
        &lt;script&gt;
            var playerParam = {
              "pcode": "YOUR_PCODE",
              "playerBrandingId": "YOUR_PLAYER_ID",
              "skin": {
                // Config contains the configuration setting for player skin. Change to your local config when necessary.
                "config": "<span class="ph"><strong class="ph b"><em class="ph i">url_where_hosted</em></strong></span>/skin.json"
              },
               "google-ima-ads-manager": {
                 "all_ads": [              
                    {                
                    "position_type":"r",                
                    "tag_url":"//pubads.g.doubleclick.net/1234567/ads?sz=640x480&amp;iu=/12345/pb_preroll_ad&amp;ciu_szs&amp;impl=s&amp;cmsid=123&amp;vid=1234567abcdefg&amp;gdfp_req=1&amp;env=vp&amp;output=xml_vast2&amp;unviewed_position_start=1&amp;url=[referrer_url]&amp;description_url=[description_url]&amp;correlator=[timestamp]"              
                    }            
                  ]          
               }
            };
            OO.ready(function() {
              window.pp = OO.Player.create("container", "YOUR_ASSET_ID", playerParam);
            });
        &lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</pre>
</div>

    <div class="section"><h2 class="title sectiontitle">Special Case: Google DFP Premium</h2>
      <p class="p">This section applies only if you are using
        DFP.</p>
<p class="p">Before trafficking ads, <strong class="ph b">if you are using DFP Premium </strong>you must first map
        your video content and all related custom metadata to Google's platform. To learn how to do
        this, see the Support Center topic <a class="xref" href="monetization_dfp.html" title="You can synch your Ooyala-hosted content with DoubleClick for Publishers (DFP) via either the Backlot API or an MRSS feed so you can monetize it with Google IMA.">Monetizing your Ooyala Content with DFP</a>.</p>

      <div class="sectiondiv">
        <p class="p"><strong class="ph b">Custom Metadata</strong></p>

        <p class="p">If your video content has been successfully ingested into DFP, all custom metadata
          key/value pairs should be visible in DFP's Content tab. These values may be used to target
          ads against particular types of content. The following screenshot, for example, is from an
          individual video asset from Ooyala’s test DFP account. <img class="image" src="../image/dfp_metadata.png" height="365" width="462" alt="DFT Metadata"/>
        </p>

      </div>
      <div class="sectiondiv">
        <p class="p"><strong class="ph b">Mapping Custom Metadata to DFP Keys</strong></p>

        <p class="p">You have the option of creating custom targeting keys on DFP Premium. These keys are then
          mapped to the key/values ingested from Backlot. To create these keys, in DFP, go to <span class="ph menucascade"><span class="ph uicontrol">Inventory</span> &gt; <span class="ph uicontrol">Custom targeting</span> &gt; <span class="ph uicontrol">+ New key</span></span>, as shown below. <img class="image" src="../image/dfp_custom_targeting.png" height="215" width="473" alt="Custom Targeting"/>For more information, go to the <a class="xref" href="https://support.google.com/dfp_premium/answer/1241378?hl=en&amp;ref_topic=1342208" target="_blank">DFP help article</a> on custom targeting.</p>

      </div>
      <strong class="ph b">Ad Rules</strong>
      <p class="p">Ad rules can define when ads are inserted, how long they should run for, what format of ads
        are run, and what to use as the ad source.</p>
<div class="p">Publishers can set up two types of ad rules
        in DFP in addition to Default Ad Rules that are already available in DFP: <ul class="ul" id="pbv4_ads_dev_google_ima__ul_mft_l5z_4x">
          <li class="li">Standard Ad Rules, which apply to a single stream of content.</li>

          <li class="li">Session Ad Rules. which applies to a visitor’s entire visit to customer’s pages. They
            can be applied across multiple content streams and across multiple sites. Session ad
            rules can only be applied to pre-roll ads.</li>

        </ul>
</div>
<p class="p">To enable ad rules for an ad:</p>
<ol class="ol" id="pbv4_ads_dev_google_ima__ad_rules">
        <li class="li">Specify your ad rules in DFP. For information on implementing DFP ad rules, go to <a class="xref" href="https://support.google.com/dfp_premium/answer/2553686?hl=en" target="_blank">https://support.google.com/dfp_premium/answer/2553686?hl=en</a>.</li>

        <li class="li">To enable your DFP ad rules to correctly render for your Google IMA V3 ad with the
          Backlot UI, click <span class="ph menucascade"><span class="ph uicontrol">MONETIZE</span> &gt; <span class="ph uicontrol">Ad Sets</span></span>, and set the ad position to "ad rules" for the desired ad. <p class="p">OR</p>
<div class="p">To
            enable your DFP ad rules to correctly render for your Google IMA V3 ad with the Backlot
            API, set "<span class="keyword parmname">ad_type</span>": "<samp class="ph codeph">rules</samp>" for the desired ad.
            For more information see <a class="xref" href="../api/ad_sets.html#ad_sets__ad_type">Ad Sets</a>.
              <div class="note note"><span class="notetitle">Note:</span> Settings applied at the page level with the ad tag url will override Backlot
              settings. However, the position type (ad rule or non ad rule) must match on the page
              level and in Backlot for ads and ad rules to properly render.</div>
</div>
</li>

      </ol>
<div class="sectiondiv"><p class="p"><strong class="ph b">Ad Targeting</strong></p>
<p class="p">To enable targeting against content metadata
          values, Google DFP requires two values to be included on your IMA tag: <strong class="ph b">cmsid</strong> and
            <strong class="ph b">vid</strong>. Once these values are included when making ad requests, the IMA ad manager
          “knows” which video asset is making the request. As a result, it returns whatever ad
          response has been defined by the publisher’s ad operations team. </p>
<p class="p"/>

        <strong class="ph b">cmsid</strong>: A unique value assigned automatically by Google to each content source. To
        locate it within the DFP Premium platform, click on the Video tab (on the upper right),
        navigate to Sources and click on the source in question. The value is “ID,” as shown below:
          <img class="image" src="../image/dfp_cmsid.png" height="298" width="543" alt="CMSID"/>
        <p class="p"><strong class="ph b">vid</strong>: A unique value for each video asset. The Ooyala-IMA integration uses Ooyala’s
          Content ID. </p>
<p class="p"/>
<p class="p">When creating the IMA Ad Manager adset, the publisher will need to
          append the IMA ad tag with the macro [oo_embedcode]. Here’s an example IMA Ad Manager tag
          with both cmsid and vid:
          </p>
<p class="p">http://googleads.g.doubleclick.net/pagead/ads?client=ca-video-pub-9498212586027311&amp;slotname=8286566767&amp;cmsid=176&amp;vid=[oo_embedcode]</p>
<div class="p">You can also pass vid and cmsid programmatically on your web page, as shown in the following
          example.
          <pre class="pre codeblock">"google-ima-ads-manager": {
  "all_ads": [              
    {                
    "position_type":"r",                
    "tag_url":"//pubads.g.doubleclick.net/gampad/ads?sz=640x480&amp;amp;iu=/12345/pb_preroll_ad&amp;amp;ciu_szs&amp;amp;impl=s&amp;amp;cmsid=123&amp;amp;vid=1234567abcdefg&amp;amp;gdfp_req=1&amp;amp;env=vp&amp;amp;output=xml_vast2&amp;amp;unviewed_position_start=1&amp;amp;url=[referrer_url]&amp;amp;description_url=[description_url]&amp;amp;correlator=[timestamp]"              
    }            
  ], 
  "additionalAdTagParameters": {
    "vid": "embed code",
    "cmsid": "349"
  }
}</pre>
</div>
</div></div>

     <div class="section"><h2 class="title sectiontitle">IMA Ad Rules</h2>
         <div class="p">Ad rules define how ads display with video content. You can create ad rules on their DFP Premium account to determine when ads play in a video, for how long, and as a result of which triggers, such as content targeting parameters. You can also target ad rules so that they apply to:
             <ul class="ul">
                 <li class="li">Specific videos, such as all episodes of a particular TV show.</li>

                 <li class="li">Video metadata, such as videos in the "sports" genre.</li>

                 <li class="li">Users' geography.</li>

                 <li class="li">Users' browsers.</li>

                 <li class="li">Custom targeting keys and values that you define.</li>

             </ul>

         </div>

         <p class="p"><strong class="ph b">Example 1:</strong> You want to show two 60-second ad breaks during an episode of a popular TV show. The TV show has specific cue points that DFP ingested from your content management system (CMS). You can set up ad rules to specify when the ads should appear (either at the pre-defined cue points or after a certain number of minutes), what types of ads appear, and how many ads should appear during each ad break.</p>

         <p class="p"><strong class="ph b">Example 2: </strong>For all sports videos on your website, you want to show pre-roll ads followed by a house ad (also called a bumper). You can set up an ad rule to specify what types of ads can show and how long they should run, then target the ad rule to videos with the correct metadata.
         </p>

     </div>

    <div class="section"><h2 class="title sectiontitle">Special Case: Google IMA V3 Companion Ads</h2>
      <div class="p"> Google IMA V3 companion ads don’t use the standard Player
          <samp class="ph codeph">WILL_SHOW_COMPANION_ADS</samp> event. This is because Google IMA itself is
        responsible for parsing and generating the companion ad. Google documents how to use the
        Google Publisher Tag (GPT) at <a class="xref" href="https://developers.google.com/interactive-media-ads/docs/sdks/html5/companions-gpt" target="_blank">https://developers.google.com/interactive-media-ads/docs/sdks/html5/companions-gpt</a>. To use companion ads:<ol class="ol" id="pbv4_ads_dev_google_ima__ol_lgw_wvy_bm">
          <li class="li">Include the following code in your webpage:
            <pre class="pre codeblock">&lt;script src="//www.googletagservices.com/tag/js/gpt.js"&gt;
&lt;/script&gt;</pre>
</li>

          <li class="li">Create the companion tag. </li>

          <li class="li">Call the right Google API to place the companion ad. For
            example:<pre class="pre codeblock">&lt;div id="cad" style="width:300px;height:250px;background-color:red"&gt;
&lt;/div&gt;
&lt;/br&gt;
&lt;script type="text/javascript"&gt;
    // Add a command to the command queue
    googletag.cmd.push(function() {     // Define the unit
            
        var adSlot1 = googletag.defineSlot(        "/5129/News/QLD", // Ad Unit Name, obtained by the provider
                     [300, 250],          
            "cad");    
        adSlot1.addService(googletag.companionAds());    
        googletag.enableServices();
        // Immediately signal to show it.
            
        googletag.display("cad");
    });
&lt;/script&gt;</pre>
</li>

        </ol>
</div>

      <div class="p">Google documents using Companion Ads with the Ad API at <a class="xref" href="https://developers.google.com/interactive-media-ads/docs/sdks/html5/companions-api" target="_blank">https://developers.google.com/interactive-media-ads/docs/sdks/html5/companions-api</a>. To display companion ads though the
          <samp class="ph codeph">WILL_SHOW_COMPANION_ADS</samp> event, slot sizes need to be defined as a page
        level setting while creating the player as follows:
        <pre class="pre codeblock">&lt;script&gt;
    var playerParam = {
      "pcode": "YOUR_PCODE",
      "playerBrandingId": "YOUR_PLAYER_ID",
      "onCreate": function(player) {
        player.mb.subscribe("*", "test", function(event, params) {
          if (event.match(/willShowCompanionAds/)) {
            console.log(params); // We get the companion ads from params
          }
        });
      },
      "skin": {
        // Config contains the configuration setting for player skin. Change to your local config when necessary.
        "config": "<span class="ph"><strong class="ph b"><em class="ph i">url_where_hosted</em></strong></span>/skin.json"
      },
      companionAd: {
       slots: [{width: 300, height: 250}, {width: 300, height: 60}]
      }
    };
    OO.ready(function() {
      window.pp = OO.Player.create("container", "YOUR_ASSET_ID", playerParam);
    });
&lt;/script&gt;       </pre>
</div>

      <p class="p">If there are any companion ads in the XML with the defined slot sizes, you can retrieve
        them by listening to the <samp class="ph codeph">WILL_SHOW_COMPANION_ADS</samp> event as demonstrated on
        the onCreate function code above.</p>

      <div class="p">This will get the ads as follows, which is the already formatted companion ad as HTML and
        the corresponding size, so you can identify the ads and place them anywhere on the page.<pre class="pre codeblock">{"ads":[
 {
   "size":"300x250",
   "ad":"&lt;Companion Ad as HTML&gt;"
 },
 {
   "size":"300x60",
   "ad":"&lt;Companion Ad as HTML&gt;"
 }
]}         </pre>
</div>

    </div>

   <div class="section"><h2 class="title sectiontitle">Special Case: Google IMA and Mobile</h2>
      
      <div class="p">Ooyala supports Google IMA for both desktop and mobile. For information about working with
        Google IMA for mobile devices, see the following mobile SDK for iOS topics. <ul class="ul">
            <li class="li">Android - <a class="xref" href="mobile_sdk_android_googleima.html#mobile_sdk_android_googleima">Integration with Google IMA on Android</a> and <a class="xref" href="mobile_sdk_android_googleima_tutorial.html#mobilesdk_android_googleima_tutorial">IMA Sample App in Action on Android</a>.</li>

          <li class="li">iOS - <a class="xref" href="mobile_sdk_ios_googleima.html#mobilesdk_ios_googleima">Integration with Google IMA on iOS</a> and <a class="xref" href="mobile_sdk_ios_googleima_tutorial.html#mobilesdk_ios_googleima_tutorial">IMA Sample App in Action on iOS</a>.</li>

          <li class="li">Supported video player platforms: <a class="xref" href="https://developers.google.com/interactive-media-ads/docs/sdks/html5/compatibility" target="_blank">Google IMA SDK for HTML5</a></li>

        </ul>
</div>

    </div>

  </div>


</body>
</html>